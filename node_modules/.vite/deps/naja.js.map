{
  "version": 3,
  "sources": ["../../naja/src/utils.ts", "../../naja/src/core/UIHandler.ts", "../../naja/src/core/FormsHandler.ts", "../../naja/src/core/RedirectHandler.ts", "../../naja/src/core/SnippetHandler.ts", "../../naja/src/core/HistoryHandler.ts", "../../naja/src/core/SnippetCache.ts", "../../naja/src/core/ScriptLoader.ts", "../../naja/src/Naja.ts", "../../naja/src/extensions/AbortExtension.ts", "../../naja/src/extensions/UniqueExtension.ts", "../../naja/src/index.esm.ts"],
  "sourcesContent": ["// ready\n\nexport const onDomReady = (callback: () => void): void => {\n\tif (document.readyState === 'loading') {\n\t\tdocument.addEventListener('DOMContentLoaded', callback);\n\t} else {\n\t\tcallback();\n\t}\n};\n\n\n// assert\n\nexport class AssertionError extends Error {}\nexport const assert: (condition: boolean, description?: string) => asserts condition = (condition, description) => {\n\tif ( ! condition) {\n\t\tconst message = `Assertion failed${description !== undefined ? `: ${description}` : '.'}`;\n\t\tthrow new AssertionError(message);\n\t}\n};\n\n\n// typed EventTarget\n\ntype TypedEventListenerFunction<ET extends EventTarget, E extends Event> = (this: ET, event: E) => boolean | void | Promise<void>;\ntype TypedEventListenerObject<E extends Event> = {\n\thandleEvent(event: E): void | Promise<void>;\n};\n\nexport type TypedEventListener<ET extends EventTarget, E extends Event> =\n\tTypedEventListenerFunction<ET, E>\n\t| TypedEventListenerObject<E>\n\t| null;\n", "import {Naja, Options, Payload} from '../Naja';\nimport {onDomReady, TypedEventListener} from '../utils';\n\nexport class UIHandler extends EventTarget {\n\tpublic selector: string = '.ajax';\n\tpublic allowedOrigins: (string | URL)[] = [window.location.origin];\n\tprivate handler = this.handleUI.bind(this);\n\n\tpublic constructor(private readonly naja: Naja) {\n\t\tsuper();\n\t\tnaja.addEventListener('init', this.initialize.bind(this));\n\t}\n\n\tprivate initialize(): void {\n\t\tonDomReady(() => this.bindUI(window.document.body));\n\t\tthis.naja.snippetHandler.addEventListener('afterUpdate', (event) => {\n\t\t\tconst {snippet} = event.detail;\n\t\t\tthis.bindUI(snippet);\n\t\t});\n\t}\n\n\tpublic bindUI(element: Element): void {\n\t\tconst selector = `a${this.selector}`;\n\n\t\tconst bindElement = (element: HTMLAnchorElement) => {\n\t\t\telement.removeEventListener('click', this.handler);\n\t\t\telement.addEventListener('click', this.handler);\n\t\t};\n\n\t\tif (element.matches(selector)) {\n\t\t\treturn bindElement(element as HTMLAnchorElement);\n\t\t}\n\n\t\tconst elements = element.querySelectorAll(selector);\n\t\telements.forEach((element) => bindElement(element as HTMLAnchorElement));\n\n\t\tconst bindForm = (form: HTMLFormElement) => {\n\t\t\tform.removeEventListener('submit', this.handler);\n\t\t\tform.addEventListener('submit', this.handler);\n\t\t};\n\n\t\tif (element instanceof HTMLFormElement) {\n\t\t\treturn bindForm(element);\n\t\t}\n\n\t\tconst forms = element.querySelectorAll('form');\n\t\tforms.forEach((form) => bindForm(form));\n\t}\n\n\tprivate handleUI(event: MouseEvent | SubmitEvent): void {\n\t\tconst element = event.currentTarget as HTMLElement;\n\t\tconst options = this.naja.prepareOptions();\n\n\t\tconst ignoreErrors = () => {\n\t\t\t// don't reject the promise in case of an error as developers have no way of handling the rejection\n\t\t\t// in this situation; errors should be handled in `naja.addEventListener('error', errorHandler)`\n\t\t};\n\n\t\tif (event instanceof MouseEvent) {\n\t\t\tif (event.altKey || event.ctrlKey || event.shiftKey || event.metaKey || event.button) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.clickElement(element, options, event).catch(ignoreErrors);\n\t\t\treturn;\n\t\t}\n\n\t\tconst {submitter} = event;\n\t\tif (this.selector === '' || element.matches(this.selector) || submitter?.matches(this.selector)) {\n\t\t\tthis.submitForm(submitter ?? element, options, event).catch(ignoreErrors);\n\t\t}\n\t}\n\n\tpublic async clickElement(element: HTMLElement, options: Options = {}, event?: MouseEvent): Promise<Payload> {\n\t\tif (element instanceof HTMLAnchorElement) {\n\t\t\treturn this.processInteraction(element, 'GET', element.href, null, options, event);\n\t\t}\n\n\t\tif ((element instanceof HTMLInputElement || element instanceof HTMLButtonElement) && element.form) {\n\t\t\treturn this.submitForm(element, options, event);\n\t\t}\n\n\t\tthrow new Error('Unsupported element in clickElement(): element must be an anchor or a submitter element attached to a form.');\n\t}\n\n\tpublic async submitForm(formOrSubmitter: HTMLFormElement | HTMLElement, options: Options = {}, event?: Event): Promise<Payload> {\n\t\tlet form: HTMLFormElement;\n\t\tlet submitter: HTMLElement | null = null;\n\n\t\tif ((formOrSubmitter instanceof HTMLInputElement || formOrSubmitter instanceof HTMLButtonElement) && formOrSubmitter.form) {\n\t\t\t// eslint-disable-next-line prefer-destructuring\n\t\t\tform = formOrSubmitter.form;\n\t\t\tsubmitter = formOrSubmitter;\n\n\t\t} else if (formOrSubmitter instanceof HTMLFormElement) {\n\t\t\tform = formOrSubmitter;\n\t\t\tsubmitter = event instanceof SubmitEvent ? event.submitter : null;\n\n\t\t} else {\n\t\t\tthrow new Error('Unsupported element in submitForm(): formOrSubmitter must be either a form or a submitter element attached to a form.');\n\t\t}\n\n\t\tconst method = (submitter?.getAttribute('formmethod') ?? form.getAttribute('method') ?? 'GET').toUpperCase();\n\t\tconst url = submitter?.getAttribute('formaction') ?? form.getAttribute('action') ?? window.location.pathname + window.location.search;\n\t\tconst data = new FormData(form, submitter);\n\n\t\treturn this.processInteraction(submitter ?? form, method, url, data, options, event);\n\t}\n\n\tpublic async processInteraction(\n\t\telement: HTMLElement,\n\t\tmethod: string,\n\t\turl: string | URL,\n\t\tdata: any | null = null,\n\t\toptions: Options = {},\n\t\tevent?: Event,\n\t): Promise<Payload> {\n\t\tif ( ! this.dispatchEvent(new CustomEvent('interaction', {cancelable: true, detail: {element, originalEvent: event, options}}))) {\n\t\t\tevent?.preventDefault();\n\t\t\treturn {};\n\t\t}\n\n\t\tif ( ! this.isUrlAllowed(`${url}`)) {\n\t\t\tthrow new Error(`Cannot dispatch async request, URL is not allowed: ${url}`);\n\t\t}\n\n\t\tevent?.preventDefault();\n\t\treturn this.naja.makeRequest(method, url, data, options);\n\t}\n\n\tpublic isUrlAllowed(url: string): boolean {\n\t\tconst urlObject = new URL(url, location.href);\n\n\t\t// ignore non-URL URIs (javascript:, data:, mailto:, ...)\n\t\tif (urlObject.origin === 'null') {\n\t\t\treturn false;\n\t\t}\n\n\t\treturn this.allowedOrigins.includes(urlObject.origin);\n\t}\n\n\tdeclare public addEventListener: <K extends keyof UIHandlerEventMap | string>(type: K, listener: TypedEventListener<UIHandler, K extends keyof UIHandlerEventMap ? UIHandlerEventMap[K] : CustomEvent>, options?: boolean | AddEventListenerOptions) => void;\n\tdeclare public removeEventListener: <K extends keyof UIHandlerEventMap | string>(type: K, listener: TypedEventListener<UIHandler, K extends keyof UIHandlerEventMap ? UIHandlerEventMap[K] : CustomEvent>, options?: boolean | AddEventListenerOptions) => void;\n}\n\nexport type InteractionEvent = CustomEvent<{element: Element, originalEvent?: Event, options: Options}>;\n\ninterface UIHandlerEventMap {\n\tinteraction: InteractionEvent;\n}\n", "import {Naja} from '../Naja';\nimport {InteractionEvent} from './UIHandler';\nimport {onDomReady} from '../utils';\n\nexport class FormsHandler {\n\tpublic netteForms: any;\n\n\tpublic constructor(private readonly naja: Naja) {\n\t\tnaja.addEventListener('init', this.initialize.bind(this));\n\t\tnaja.uiHandler.addEventListener('interaction', this.processForm.bind(this));\n\t}\n\n\tprivate initialize(): void {\n\t\tonDomReady(() => this.initForms(window.document.body));\n\t\tthis.naja.snippetHandler.addEventListener('afterUpdate', (event) => {\n\t\t\tconst {snippet} = event.detail;\n\t\t\tthis.initForms(snippet);\n\t\t});\n\t}\n\n\tprivate initForms(element: Element): void {\n\t\tconst netteForms = this.netteForms || (window as any).Nette;\n\t\tif ( ! netteForms) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (element instanceof HTMLFormElement) {\n\t\t\tnetteForms.initForm(element);\n\t\t\treturn;\n\t\t}\n\n\t\tconst forms = element.querySelectorAll('form');\n\t\tforms.forEach((form) => netteForms.initForm(form));\n\t}\n\n\tprivate processForm(event: InteractionEvent): void {\n\t\tconst {element, originalEvent} = event.detail;\n\n\t\tconst isForm = element instanceof HTMLFormElement;\n\t\tconst isSubmitter = (element instanceof HTMLInputElement || element instanceof HTMLButtonElement) && element.form;\n\n\t\tif (isSubmitter) {\n\t\t\telement.form['nette-submittedBy'] = element;\n\t\t}\n\n\t\tconst netteForms = this.netteForms || (window as any).Nette;\n\t\tif ((isForm || isSubmitter) && netteForms && ! netteForms.validateForm(element)) {\n\t\t\toriginalEvent?.stopImmediatePropagation();\n\t\t\toriginalEvent?.preventDefault();\n\t\t\tevent.preventDefault();\n\t\t}\n\t}\n}\n", "import {Naja, Options} from '../Naja';\nimport {TypedEventListener} from '../utils';\n\ndeclare module '../Naja' {\n\tinterface Options {\n\t\tforceRedirect?: boolean;\n\t}\n\n\tinterface Payload {\n\t\tredirect?: string;\n\t}\n}\n\ninterface LocationAdapter {\n\tassign(url: string): void;\n}\n\nexport class RedirectHandler extends EventTarget {\n\tpublic locationAdapter: LocationAdapter;\n\n\tpublic constructor(private readonly naja: Naja) {\n\t\tsuper();\n\n\t\tnaja.uiHandler.addEventListener('interaction', (event) => {\n\t\t\tconst {element, options} = event.detail;\n\t\t\tif (element.hasAttribute('data-naja-force-redirect') || (element as HTMLInputElement).form?.hasAttribute('data-naja-force-redirect')) {\n\t\t\t\tconst value = element.getAttribute('data-naja-force-redirect') ?? (element as HTMLInputElement).form?.getAttribute('data-naja-force-redirect');\n\t\t\t\toptions.forceRedirect = value !== 'off';\n\t\t\t}\n\t\t});\n\n\t\tnaja.addEventListener('success', (event) => {\n\t\t\tconst {payload, options} = event.detail;\n\t\t\tif ( ! payload.redirect) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.makeRedirect(payload.redirect, options.forceRedirect ?? false, options);\n\t\t\tevent.stopImmediatePropagation();\n\t\t});\n\n\t\tthis.locationAdapter = {\n\t\t\tassign: (url) => window.location.assign(url),\n\t\t};\n\t}\n\n\tpublic makeRedirect(url: string | URL, force: boolean, options: Options = {}): void {\n\t\tif (url instanceof URL) {\n\t\t\turl = url.href;\n\t\t}\n\n\t\tlet isHardRedirect = force || ! this.naja.uiHandler.isUrlAllowed(url);\n\t\tconst canRedirect = this.dispatchEvent(new CustomEvent('redirect', {\n\t\t\tcancelable: true,\n\t\t\tdetail: {\n\t\t\t\turl,\n\t\t\t\tsetUrl(value: string) {\n\t\t\t\t\turl = value;\n\t\t\t\t},\n\t\t\t\tisHardRedirect,\n\t\t\t\tsetHardRedirect(value: boolean) {\n\t\t\t\t\tisHardRedirect = !!value;\n\t\t\t\t},\n\t\t\t\toptions,\n\t\t\t},\n\t\t}));\n\n\t\tif ( ! canRedirect) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (isHardRedirect) {\n\t\t\tthis.locationAdapter.assign(url);\n\n\t\t} else {\n\t\t\tthis.naja.makeRequest('GET', url, null, options);\n\t\t}\n\t}\n\n\tdeclare public addEventListener: <K extends keyof RedirectHandlerEventMap | string>(type: K, listener: TypedEventListener<RedirectHandler, K extends keyof RedirectHandlerEventMap ? RedirectHandlerEventMap[K] : CustomEvent>, options?: boolean | AddEventListenerOptions) => void;\n\tdeclare public removeEventListener: <K extends keyof RedirectHandlerEventMap | string>(type: K, listener: TypedEventListener<RedirectHandler, K extends keyof RedirectHandlerEventMap ? RedirectHandlerEventMap[K] : CustomEvent>, options?: boolean | AddEventListenerOptions) => void;\n}\n\nexport type RedirectEvent = CustomEvent<{url: string, setUrl: (value: string) => void, isHardRedirect: boolean, setHardRedirect: (value: boolean) => void, options: Options}>;\n\ninterface RedirectHandlerEventMap {\n\tredirect: RedirectEvent;\n}\n", "import {Naja, Options} from '../Naja';\nimport {TypedEventListener} from '../utils';\n\ndeclare module '../Naja' {\n\tinterface Payload {\n\t\tsnippets?: Record<string, string>;\n\t}\n}\n\nexport type SnippetUpdateOperation =\n\t((snippet: Element, content: string) => void | Promise<void>) | {\n\t\tupdateElement(snippet: Element, content: string): void | Promise<void>;\n\t\tupdateIndex(currentContent: string, newContent: string): string;\n\t};\n\nexport class SnippetHandler extends EventTarget {\n\tpublic readonly op: Record<'replace' | 'prepend' | 'append', SnippetUpdateOperation> = {\n\t\treplace: {\n\t\t\tupdateElement(snippet, content) {\n\t\t\t\tsnippet.innerHTML = content;\n\t\t\t},\n\t\t\tupdateIndex(_, newContent) {\n\t\t\t\treturn newContent;\n\t\t\t},\n\t\t},\n\t\tprepend: {\n\t\t\tupdateElement(snippet, content) {\n\t\t\t\tsnippet.insertAdjacentHTML('afterbegin', content);\n\t\t\t},\n\t\t\tupdateIndex(currentContent, newContent) {\n\t\t\t\treturn newContent + currentContent;\n\t\t\t},\n\t\t},\n\t\tappend: {\n\t\t\tupdateElement(snippet, content) {\n\t\t\t\tsnippet.insertAdjacentHTML('beforeend', content);\n\t\t\t},\n\t\t\tupdateIndex(currentContent, newContent) {\n\t\t\t\treturn currentContent + newContent;\n\t\t\t},\n\t\t},\n\t};\n\n\tpublic constructor(naja: Naja) {\n\t\tsuper();\n\t\tnaja.addEventListener('success', (event) => {\n\t\t\tconst {options, payload} = event.detail;\n\t\t\tif ( ! payload.snippets) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.updateSnippets(payload.snippets, false, options);\n\t\t});\n\t}\n\n\tpublic static findSnippets(\n\t\tpredicate?: (snippet: Element) => boolean,\n\t\tdocument: Document = window.document,\n\t): Record<string, string> {\n\t\tconst result: Record<string, string> = {};\n\t\tconst snippets = document.querySelectorAll('[id^=\"snippet-\"]');\n\t\tsnippets.forEach((snippet) => {\n\t\t\tif (predicate?.(snippet) ?? true) {\n\t\t\t\tresult[snippet.id] = snippet.innerHTML;\n\t\t\t}\n\t\t});\n\n\t\treturn result;\n\t}\n\n\tpublic async updateSnippets(snippets: Record<string, string>, fromCache = false, options: Options = {}): Promise<void> {\n\t\tawait Promise.all(Object.keys(snippets).map(async (id) => {\n\t\t\tconst snippet = document.getElementById(id);\n\t\t\tif (snippet) {\n\t\t\t\tawait this.updateSnippet(snippet, snippets[id], fromCache, options);\n\t\t\t}\n\t\t}));\n\t}\n\n\tpublic async updateSnippet(snippet: Element, content: string, fromCache: boolean, options: Options): Promise<void> {\n\t\tlet operation = this.op.replace;\n\t\tif ((snippet.hasAttribute('data-naja-snippet-prepend') || snippet.hasAttribute('data-ajax-prepend')) && ! fromCache) {\n\t\t\toperation = this.op.prepend;\n\t\t} else if ((snippet.hasAttribute('data-naja-snippet-append') || snippet.hasAttribute('data-ajax-append')) && ! fromCache) {\n\t\t\toperation = this.op.append;\n\t\t}\n\n\t\tconst canUpdate = this.dispatchEvent(new CustomEvent('beforeUpdate', {\n\t\t\tcancelable: true,\n\t\t\tdetail: {\n\t\t\t\tsnippet,\n\t\t\t\tcontent,\n\t\t\t\tfromCache,\n\t\t\t\toperation,\n\t\t\t\tchangeOperation(value: SnippetUpdateOperation) {\n\t\t\t\t\toperation = value;\n\t\t\t\t},\n\t\t\t\toptions,\n\t\t\t},\n\t\t}));\n\n\t\tif ( ! canUpdate) {\n\t\t\treturn;\n\t\t}\n\n\t\tthis.dispatchEvent(new CustomEvent('pendingUpdate', {\n\t\t\tdetail: {\n\t\t\t\tsnippet,\n\t\t\t\tcontent,\n\t\t\t\tfromCache,\n\t\t\t\toperation,\n\t\t\t\toptions,\n\t\t\t},\n\t\t}));\n\n\t\tconst updateElement = typeof operation === 'function' ? operation : operation.updateElement;\n\t\tconst updateOperation = updateElement(snippet, content);\n\t\tif (updateOperation instanceof Promise) {\n\t\t\tawait updateOperation;\n\t\t}\n\n\t\tthis.dispatchEvent(new CustomEvent('afterUpdate', {\n\t\t\tdetail: {\n\t\t\t\tsnippet,\n\t\t\t\tcontent,\n\t\t\t\tfromCache,\n\t\t\t\toperation,\n\t\t\t\toptions,\n\t\t\t},\n\t\t}));\n\t}\n\n\tdeclare public addEventListener: <K extends keyof SnippetHandlerEventMap | string>(type: K, listener: TypedEventListener<SnippetHandler, K extends keyof SnippetHandlerEventMap ? SnippetHandlerEventMap[K] : CustomEvent>, options?: boolean | AddEventListenerOptions) => void;\n\tdeclare public removeEventListener: <K extends keyof SnippetHandlerEventMap | string>(type: K, listener: TypedEventListener<SnippetHandler, K extends keyof SnippetHandlerEventMap ? SnippetHandlerEventMap[K] : CustomEvent>, options?: boolean | AddEventListenerOptions) => void;\n}\n\nexport type BeforeUpdateEvent = CustomEvent<{snippet: Element, content: string, fromCache: boolean, operation: SnippetUpdateOperation, changeOperation: (value: SnippetUpdateOperation) => void, options: Options}>;\nexport type PendingUpdateEvent = CustomEvent<{snippet: Element, content: string, fromCache: boolean, operation: SnippetUpdateOperation, options: Options}>;\nexport type AfterUpdateEvent = CustomEvent<{snippet: Element, content: string, fromCache: boolean, operation: SnippetUpdateOperation, options: Options}>;\n\ninterface SnippetHandlerEventMap {\n\tbeforeUpdate: BeforeUpdateEvent;\n\tpendingUpdate: PendingUpdateEvent;\n\tafterUpdate: AfterUpdateEvent;\n}\n", "import {BeforeEvent, Naja, Options, SuccessEvent} from '../Naja';\nimport {RedirectEvent} from './RedirectHandler';\nimport {InteractionEvent} from './UIHandler';\nimport {onDomReady, TypedEventListener} from '../utils';\n\nconst originalTitleKey = Symbol();\n\ndeclare module '../Naja' {\n\tinterface Options {\n\t\thistory?: HistoryMode;\n\t\thref?: string;\n\t\t[originalTitleKey]?: string;\n\t}\n\n\tinterface Payload {\n\t\tpostGet?: boolean;\n\t\turl?: string;\n\t}\n}\n\nexport interface HistoryState extends Record<string, any> {\n\tsource: string;\n\tcursor: number;\n\thref: string;\n}\n\nexport interface HistoryAdapter {\n\tstate: HistoryState | null;\n\treplaceState(state: HistoryState, title: string, url: string): void;\n\tpushState(state: HistoryState, title: string, url: string): void;\n}\n\nexport type HistoryMode = boolean | 'replace';\n\nexport class HistoryHandler extends EventTarget {\n\tprivate initialized = false;\n\tprivate cursor = 0;\n\n\tpublic popStateHandler = this.handlePopState.bind(this);\n\tpublic historyAdapter: HistoryAdapter;\n\n\tpublic constructor(private readonly naja: Naja) {\n\t\tsuper();\n\n\t\tnaja.addEventListener('init', this.initialize.bind(this));\n\t\tnaja.addEventListener('before', this.saveUrl.bind(this));\n\t\tnaja.addEventListener('before', this.saveOriginalTitle.bind(this));\n\t\tnaja.addEventListener('before', this.replaceInitialStateBeforeRequest.bind(this));\n\t\tnaja.addEventListener('success', this.pushNewState.bind(this));\n\n\t\tnaja.redirectHandler.addEventListener('redirect', this.saveRedirectedUrl.bind(this));\n\n\t\tnaja.uiHandler.addEventListener('interaction', this.configureMode.bind(this));\n\n\t\tthis.historyAdapter = {\n\t\t\tget state() {\n\t\t\t\treturn window.history.state;\n\t\t\t},\n\t\t\treplaceState: (state, title, url) => window.history.replaceState(state, title, url),\n\t\t\tpushState: (state, title, url) => window.history.pushState(state, title, url),\n\t\t};\n\t}\n\n\tpublic set uiCache(value: boolean) {\n\t\tconsole.warn('Naja: HistoryHandler.uiCache is deprecated, use options.snippetCache instead.');\n\t\tthis.naja.defaultOptions.snippetCache = value;\n\t}\n\n\tprivate handlePopState(event: PopStateEvent): void {\n\t\tconst {state} = event;\n\t\tif (state?.source !== 'naja') {\n\t\t\treturn;\n\t\t}\n\n\t\tthis.replaceInitialState();\n\n\t\tconst direction = state.cursor - this.cursor;\n\t\tthis.cursor = state.cursor;\n\n\t\tconst options = this.naja.prepareOptions();\n\t\tthis.dispatchEvent(new CustomEvent('restoreState', {detail: {state, direction, options}}));\n\t}\n\n\tprivate initialize(): void {\n\t\twindow.addEventListener('popstate', this.popStateHandler);\n\n\t\tif (this.historyAdapter.state?.source === 'naja') {\n\t\t\tthis.cursor = this.historyAdapter.state.cursor;\n\t\t\tthis.replaceInitialState();\n\t\t}\n\t}\n\n\tprivate saveOriginalTitle(event: BeforeEvent): void {\n\t\tconst {options} = event.detail;\n\t\toptions[originalTitleKey] = window.document.title;\n\t}\n\n\tprivate saveUrl(event: BeforeEvent): void {\n\t\tconst {url, options} = event.detail;\n\t\toptions.href ??= url;\n\t}\n\n\tprivate saveRedirectedUrl(event: RedirectEvent): void {\n\t\tconst {url, options} = event.detail;\n\t\toptions.href = url;\n\t}\n\n\tprivate replaceInitialStateBeforeRequest(event: BeforeEvent): void {\n\t\tconst {options} = event.detail;\n\t\tconst mode = HistoryHandler.normalizeMode(options.history);\n\t\tif (mode !== false) {\n\t\t\tthis.replaceInitialState(options);\n\t\t}\n\t}\n\n\tprivate replaceInitialState(options: Options = this.naja.prepareOptions()): void {\n\t\tif ( ! this.initialized) {\n\t\t\tonDomReady(() => this.historyAdapter.replaceState(\n\t\t\t\tthis.buildState(window.location.href, 'replace', this.cursor, options),\n\t\t\t\twindow.document.title,\n\t\t\t\twindow.location.href,\n\t\t\t));\n\n\t\t\tthis.initialized = true;\n\t\t}\n\t}\n\n\tprivate configureMode(event: InteractionEvent): void {\n\t\tconst {element, options} = event.detail;\n\t\tif (element.hasAttribute('data-naja-history') || (element as HTMLInputElement).form?.hasAttribute('data-naja-history')) {\n\t\t\tconst value = element.getAttribute('data-naja-history') ?? (element as HTMLInputElement).form?.getAttribute('data-naja-history');\n\t\t\toptions.history = HistoryHandler.normalizeMode(value);\n\t\t}\n\t}\n\n\tpublic static normalizeMode(mode: string | boolean | null | undefined): HistoryMode {\n\t\tif (mode === 'off' || mode === false) {\n\t\t\treturn false;\n\n\t\t} else if (mode === 'replace') {\n\t\t\treturn 'replace';\n\t\t}\n\n\t\treturn true;\n\t}\n\n\tprivate pushNewState(event: SuccessEvent): void {\n\t\tconst {payload, options} = event.detail;\n\t\tconst mode = HistoryHandler.normalizeMode(options.history);\n\t\tif (mode === false) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (payload.postGet && payload.url) {\n\t\t\toptions.href = payload.url;\n\t\t}\n\n\t\tconst method = mode === 'replace' ? 'replaceState' : 'pushState';\n\t\tconst cursor = mode === 'replace' ? this.cursor : ++this.cursor;\n\t\tconst state = this.buildState(options.href!, mode, cursor, options);\n\n\t\t// before the state is pushed into history, revert to the original title\n\t\tconst newTitle = window.document.title;\n\t\twindow.document.title = options[originalTitleKey]!;\n\n\t\tthis.historyAdapter[method](\n\t\t\tstate,\n\t\t\tnewTitle,\n\t\t\toptions.href!,\n\t\t);\n\n\t\t// after the state is pushed into history, update back to the new title\n\t\twindow.document.title = newTitle;\n\t}\n\n\tprivate buildState(href: string, mode: HistoryMode, cursor: number, options: Options): HistoryState {\n\t\tconst state: HistoryState = {\n\t\t\tsource: 'naja',\n\t\t\tcursor,\n\t\t\thref,\n\t\t};\n\n\t\tthis.dispatchEvent(new CustomEvent('buildState', {\n\t\t\tdetail: {\n\t\t\t\tstate,\n\t\t\t\toperation: mode === 'replace' ? 'replaceState' : 'pushState',\n\t\t\t\tisInitial: ! this.initialized,\n\t\t\t\toptions,\n\t\t\t},\n\t\t}));\n\n\t\treturn state;\n\t}\n\n\tdeclare public addEventListener: <K extends keyof HistoryHandlerEventMap | string>(type: K, listener: TypedEventListener<HistoryHandler, K extends keyof HistoryHandlerEventMap ? HistoryHandlerEventMap[K] : CustomEvent>, options?: boolean | AddEventListenerOptions) => void;\n\tdeclare public removeEventListener: <K extends keyof HistoryHandlerEventMap | string>(type: K, listener: TypedEventListener<HistoryHandler, K extends keyof HistoryHandlerEventMap ? HistoryHandlerEventMap[K] : CustomEvent>, options?: boolean | AddEventListenerOptions) => void;\n}\n\nexport type BuildStateEvent = CustomEvent<{state: HistoryState, operation: 'pushState' | 'replaceState', isInitial: boolean, options: Options}>;\nexport type RestoreStateEvent = CustomEvent<{state: HistoryState, direction: number, options: Options}>;\n\ninterface HistoryHandlerEventMap {\n\tbuildState: BuildStateEvent;\n\trestoreState: RestoreStateEvent;\n}\n", "import {Naja, Options} from '../Naja';\nimport {InteractionEvent} from './UIHandler';\nimport {BuildStateEvent, HistoryState, RestoreStateEvent} from './HistoryHandler';\nimport {PendingUpdateEvent, SnippetHandler} from './SnippetHandler';\nimport {onDomReady, TypedEventListener} from '../utils';\n\ndeclare module '../Naja' {\n\tinterface Options {\n\t\tsnippetCache?: boolean | SnippetCacheStorageType;\n\t}\n}\n\ndeclare module './HistoryHandler' {\n\tinterface HistoryState {\n\t\tsnippets?: {\n\t\t\treadonly storage: SnippetCacheStorageType;\n\t\t\treadonly key: SnippetCacheKey;\n\t\t};\n\t}\n}\n\nexport class SnippetCache extends EventTarget {\n\tprivate readonly storages: Record<SnippetCacheStorageType, SnippetCacheStorage>;\n\tprivate currentSnippets: Map<string, string> = new Map();\n\n\tprivate static parser = new DOMParser();\n\n\tpublic constructor(private readonly naja: Naja) {\n\t\tsuper();\n\n\t\tthis.storages = {\n\t\t\toff: new OffCacheStorage(naja),\n\t\t\thistory: new HistoryCacheStorage(),\n\t\t\tsession: new SessionCacheStorage(),\n\t\t};\n\n\t\tnaja.addEventListener('init', this.initializeIndex.bind(this));\n\t\tnaja.snippetHandler.addEventListener('pendingUpdate', this.updateIndex.bind(this));\n\n\t\tnaja.uiHandler.addEventListener('interaction', this.configureCache.bind(this));\n\t\tnaja.historyHandler.addEventListener('buildState', this.buildHistoryState.bind(this));\n\t\tnaja.historyHandler.addEventListener('restoreState', this.restoreHistoryState.bind(this));\n\t}\n\n\tprivate resolveStorage(option?: boolean | SnippetCacheStorageType): SnippetCacheStorage {\n\t\tlet storageType: SnippetCacheStorageType;\n\t\tif (option === true || option === undefined) {\n\t\t\tstorageType = 'history';\n\t\t} else if (option === false) {\n\t\t\tstorageType = 'off';\n\t\t} else {\n\t\t\tstorageType = option;\n\t\t}\n\n\t\treturn this.storages[storageType];\n\t}\n\n\tprivate static shouldCacheSnippet(snippet: Element): boolean {\n\t\treturn ! snippet.hasAttribute('data-naja-history-nocache')\n\t\t\t&& ! snippet.hasAttribute('data-history-nocache')\n\t\t\t&& ( ! snippet.hasAttribute('data-naja-snippet-cache')\n\t\t\t\t|| snippet.getAttribute('data-naja-snippet-cache') !== 'off');\n\t}\n\n\tprivate initializeIndex(): void {\n\t\tonDomReady(() => {\n\t\t\tconst currentSnippets = SnippetHandler.findSnippets(SnippetCache.shouldCacheSnippet);\n\t\t\tthis.currentSnippets = new Map(Object.entries(currentSnippets));\n\t\t});\n\t}\n\n\tprivate updateIndex(event: PendingUpdateEvent): void {\n\t\tconst {snippet, content, operation} = event.detail;\n\t\tif ( ! SnippetCache.shouldCacheSnippet(snippet)) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst currentContent = this.currentSnippets.get(snippet.id) ?? '';\n\t\tconst updateIndex = typeof operation === 'object'\n\t\t\t? operation.updateIndex\n\t\t\t: () => content;\n\n\t\tthis.currentSnippets.set(\n\t\t\tsnippet.id,\n\t\t\tupdateIndex(currentContent, content),\n\t\t);\n\n\t\t// update nested snippets\n\t\tconst snippetContent = SnippetCache.parser.parseFromString(content, 'text/html');\n\t\tconst nestedSnippets = SnippetHandler.findSnippets(SnippetCache.shouldCacheSnippet, snippetContent);\n\t\tfor (const [id, content] of Object.entries(nestedSnippets)) {\n\t\t\tthis.currentSnippets.set(id, content);\n\t\t}\n\t}\n\n\tprivate configureCache(event: InteractionEvent): void {\n\t\tconst {element, options} = event.detail;\n\n\t\tif ( ! element) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (element.hasAttribute('data-naja-snippet-cache') || (element as HTMLInputElement).form?.hasAttribute('data-naja-snippet-cache')\n\t\t\t|| element.hasAttribute('data-naja-history-cache') || (element as HTMLInputElement).form?.hasAttribute('data-naja-history-cache')\n\t\t) {\n\t\t\tconst value = element.getAttribute('data-naja-snippet-cache')\n\t\t\t\t?? (element as HTMLInputElement).form?.getAttribute('data-naja-snippet-cache')\n\t\t\t\t?? element.getAttribute('data-naja-history-cache')\n\t\t\t\t?? (element as HTMLInputElement).form?.getAttribute('data-naja-history-cache');\n\t\t\toptions.snippetCache = value as SnippetCacheStorageType;\n\t\t}\n\t}\n\n\tprivate buildHistoryState(event: BuildStateEvent): void {\n\t\tconst {state, options} = event.detail;\n\n\t\tif ('historyUiCache' in options) {\n\t\t\tconsole.warn('Naja: options.historyUiCache is deprecated, use options.snippetCache instead.');\n\t\t\toptions.snippetCache = options.historyUiCache;\n\t\t}\n\n\t\tconst presentSnippetIds = Object.keys(SnippetHandler.findSnippets(SnippetCache.shouldCacheSnippet));\n\t\tconst snippets = Object.fromEntries(Array.from(this.currentSnippets).filter(([id]) => presentSnippetIds.includes(id)));\n\n\t\tif ( ! this.dispatchEvent(new CustomEvent('store', {cancelable: true, detail: {snippets, state, options}}))) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst storage = this.resolveStorage(options.snippetCache);\n\t\tstate.snippets = {\n\t\t\tstorage: storage.type,\n\t\t\tkey: storage.store(snippets),\n\t\t};\n\t}\n\n\tprivate restoreHistoryState(event: RestoreStateEvent): void {\n\t\tconst {state, options} = event.detail;\n\n\t\tif (state.snippets === undefined) {\n\t\t\treturn;\n\t\t}\n\n\t\toptions.snippetCache = state.snippets.storage;\n\t\tif ( ! this.dispatchEvent(new CustomEvent('fetch', {cancelable: true, detail: {state, options}}))) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst storage = this.resolveStorage(options.snippetCache);\n\t\tconst snippets = storage.fetch(state.snippets.key, state, options);\n\t\tif (snippets === null) {\n\t\t\treturn;\n\t\t}\n\n\t\tif ( ! this.dispatchEvent(new CustomEvent('restore', {cancelable: true, detail: {snippets, state, options}}))) {\n\t\t\treturn;\n\t\t}\n\n\t\tthis.naja.snippetHandler.updateSnippets(snippets, true, options);\n\t}\n\n\tdeclare public addEventListener: <K extends keyof SnippetCacheEventMap | string>(type: K, listener: TypedEventListener<SnippetHandler, K extends keyof SnippetCacheEventMap ? SnippetCacheEventMap[K] : CustomEvent>, options?: boolean | AddEventListenerOptions) => void;\n\tdeclare public removeEventListener: <K extends keyof SnippetCacheEventMap | string>(type: K, listener: TypedEventListener<SnippetHandler, K extends keyof SnippetCacheEventMap ? SnippetCacheEventMap[K] : CustomEvent>, options?: boolean | AddEventListenerOptions) => void;\n}\n\nexport type StoreEvent = CustomEvent<{snippets: CachedSnippets, state: HistoryState, options: Options}>;\nexport type FetchEvent = CustomEvent<{state: HistoryState, options: Options}>;\nexport type RestoreEvent = CustomEvent<{snippets: CachedSnippets, state: HistoryState, options: Options}>;\n\ninterface SnippetCacheEventMap {\n\tstore: StoreEvent;\n\tfetch: FetchEvent;\n\trestore: RestoreEvent;\n}\n\ntype CachedSnippets = Record<string, string>;\ntype SnippetCacheKey = CachedSnippets | string | null;\n\ntype SnippetCacheStorageType = 'off' | 'history' | 'session';\n\ninterface SnippetCacheStorage {\n\treadonly type: SnippetCacheStorageType;\n\tstore(data: CachedSnippets): SnippetCacheKey;\n\tfetch(key: SnippetCacheKey, state: HistoryState, options: Options): CachedSnippets | null;\n}\n\nclass OffCacheStorage implements SnippetCacheStorage {\n\tpublic readonly type = 'off';\n\tpublic constructor(private readonly naja: Naja) {}\n\n\tpublic store(): null {\n\t\treturn null;\n\t}\n\n\tpublic fetch(key: null, state: HistoryState, options: Options): CachedSnippets | null {\n\t\tthis.naja.makeRequest(\n\t\t\t'GET',\n\t\t\tstate.href,\n\t\t\tnull,\n\t\t\t{\n\t\t\t\t...options,\n\t\t\t\thistory: false,\n\t\t\t\tsnippetCache: false,\n\t\t\t},\n\t\t);\n\n\t\treturn null;\n\t}\n}\n\nclass HistoryCacheStorage implements SnippetCacheStorage {\n\tpublic readonly type = 'history';\n\n\tpublic store(data: CachedSnippets): CachedSnippets {\n\t\treturn data;\n\t}\n\n\tpublic fetch(key: CachedSnippets): CachedSnippets | null {\n\t\treturn key;\n\t}\n}\n\nclass SessionCacheStorage implements SnippetCacheStorage {\n\tpublic readonly type = 'session';\n\n\tpublic store(data: CachedSnippets): string {\n\t\tconst key = Math.random().toString(36).substring(2, 8);\n\t\twindow.sessionStorage.setItem(key, JSON.stringify(data));\n\t\treturn key;\n\t}\n\n\tpublic fetch(key: string): CachedSnippets | null {\n\t\tconst data = window.sessionStorage.getItem(key);\n\t\tif (data === null) {\n\t\t\treturn null;\n\t\t}\n\n\t\treturn JSON.parse(data);\n\t}\n}\n", "import {Naja} from '../Naja';\nimport {onDomReady} from '../utils';\n\nexport class ScriptLoader {\n\tprivate loadedScripts = new Set<string>();\n\n\tprivate static parser = new DOMParser();\n\n\tpublic constructor(private readonly naja: Naja) {\n\t\tnaja.addEventListener('init', this.initialize.bind(this));\n\t}\n\n\tprivate initialize(): void {\n\t\tonDomReady(() => {\n\t\t\tdocument.querySelectorAll('script[data-naja-script-id]').forEach((script) => {\n\t\t\t\tconst scriptId = script.getAttribute('data-naja-script-id');\n\t\t\t\tif (scriptId !== null && scriptId !== '') {\n\t\t\t\t\tthis.loadedScripts.add(scriptId);\n\t\t\t\t}\n\t\t\t});\n\t\t});\n\n\t\tthis.naja.snippetHandler.addEventListener('afterUpdate', (event) => {\n\t\t\tconst {content} = event.detail;\n\t\t\tthis.loadScripts(content);\n\t\t});\n\t}\n\n\tpublic loadScripts(content: string): void;\n\tpublic loadScripts(snippets: Record<string, string>): void;\n\tpublic loadScripts(snippetsOrSnippet: Record<string, string> | string): void {\n\t\tif (typeof snippetsOrSnippet === 'string') {\n\t\t\tthis.loadScriptsInSnippet(snippetsOrSnippet);\n\t\t\treturn;\n\t\t}\n\n\t\tObject.keys(snippetsOrSnippet).forEach((id) => {\n\t\t\tconst content = snippetsOrSnippet[id];\n\t\t\tthis.loadScriptsInSnippet(content);\n\t\t});\n\t}\n\n\tprivate loadScriptsInSnippet(content: string) {\n\t\tif (!/<script/i.test(content)) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst snippetContent = ScriptLoader.parser.parseFromString(content, 'text/html');\n\t\tconst scripts = snippetContent.querySelectorAll('script');\n\n\t\tscripts.forEach((script) => {\n\t\t\tconst scriptId = script.getAttribute('data-naja-script-id');\n\t\t\tif (scriptId !== null && scriptId !== '' && this.loadedScripts.has(scriptId)) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst scriptEl = window.document.createElement('script');\n\t\t\tscriptEl.innerHTML = script.innerHTML;\n\n\t\t\tif (script.hasAttributes()) {\n\t\t\t\tfor (const attribute of script.attributes) {\n\t\t\t\t\tscriptEl.setAttribute(attribute.name, attribute.value);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\twindow.document.head.appendChild(scriptEl)\n\t\t\t\t.parentNode!.removeChild(scriptEl);\n\n\t\t\tif (scriptId !== null && scriptId !== '') {\n\t\t\t\tthis.loadedScripts.add(scriptId);\n\t\t\t}\n\t\t});\n\t}\n}\n", "import {UIHandler} from './core/UIHandler';\nimport {FormsHandler} from './core/FormsHandler';\nimport {RedirectHandler} from './core/RedirectHandler';\nimport {SnippetHandler} from './core/SnippetHandler';\nimport {HistoryHandler} from './core/HistoryHandler';\nimport {SnippetCache} from './core/SnippetCache';\nimport {ScriptLoader} from './core/ScriptLoader';\nimport {TypedEventListener} from './utils';\n\nexport interface Options extends Record<string, any> {\n\tfetch?: RequestInit;\n}\n\n// eslint-disable-next-line @typescript-eslint/no-empty-object-type\nexport interface Payload extends Record<string, any> {}\n\nexport class Naja extends EventTarget {\n\tpublic readonly VERSION: number = 3;\n\n\tprivate initialized: boolean = false;\n\n\tpublic readonly uiHandler: UIHandler;\n\tpublic readonly redirectHandler: RedirectHandler;\n\tpublic readonly snippetHandler: SnippetHandler;\n\tpublic readonly formsHandler: FormsHandler;\n\tpublic readonly historyHandler: HistoryHandler;\n\tpublic readonly snippetCache: SnippetCache;\n\tpublic readonly scriptLoader: ScriptLoader;\n\tprivate readonly extensions: Extension[] = [];\n\n\tpublic defaultOptions: Options = {};\n\n\n\tpublic constructor(\n\t\tuiHandler?: { new(naja: Naja): UIHandler },\n\t\tredirectHandler?: { new(naja: Naja): RedirectHandler },\n\t\tsnippetHandler?: { new(naja: Naja): SnippetHandler },\n\t\tformsHandler?: { new(naja: Naja): FormsHandler },\n\t\thistoryHandler?: { new(naja: Naja): HistoryHandler },\n\t\tsnippetCache?: { new(naja: Naja): SnippetCache },\n\t\tscriptLoader?: { new(naja: Naja): ScriptLoader },\n\t) {\n\t\tsuper();\n\t\tthis.uiHandler = new (uiHandler ?? UIHandler)(this);\n\t\tthis.redirectHandler = new (redirectHandler ?? RedirectHandler)(this);\n\t\tthis.snippetHandler = new (snippetHandler ?? SnippetHandler)(this);\n\t\tthis.formsHandler = new (formsHandler ?? FormsHandler)(this);\n\t\tthis.historyHandler = new (historyHandler ?? HistoryHandler)(this);\n\t\tthis.snippetCache = new (snippetCache ?? SnippetCache)(this);\n\t\tthis.scriptLoader = new (scriptLoader ?? ScriptLoader)(this);\n\t}\n\n\n\tpublic registerExtension(extension: Extension): void {\n\t\tif (this.initialized) {\n\t\t\textension.initialize(this);\n\t\t}\n\n\t\tthis.extensions.push(extension);\n\t}\n\n\n\tpublic initialize(defaultOptions: Options = {}): void {\n\t\tif (this.initialized) {\n\t\t\tthrow new Error('Cannot initialize Naja, it is already initialized.');\n\t\t}\n\n\t\tthis.defaultOptions = this.prepareOptions(defaultOptions);\n\t\tthis.extensions.forEach((extension) => extension.initialize(this));\n\n\t\tthis.dispatchEvent(new CustomEvent('init', {detail: {defaultOptions: this.defaultOptions}}));\n\t\tthis.initialized = true;\n\t}\n\n\n\tpublic prepareOptions(options?: Options): Options {\n\t\treturn {\n\t\t\t...this.defaultOptions,\n\t\t\t...options,\n\t\t\tfetch: {\n\t\t\t\t...this.defaultOptions.fetch,\n\t\t\t\t...options?.fetch,\n\t\t\t},\n\t\t};\n\t}\n\n\n\tpublic async makeRequest(\n\t\tmethod: string,\n\t\turl: string | URL,\n\t\tdata: any | null = null,\n\t\toptions: Options = {},\n\t): Promise<Payload> {\n\t\t// normalize url to instanceof URL\n\t\tif (typeof url === 'string') {\n\t\t\turl = new URL(url, location.href);\n\t\t}\n\n\t\toptions = this.prepareOptions(options);\n\n\t\tconst headers = new Headers(options.fetch!.headers || {});\n\t\tconst body = this.transformData(url, method, data);\n\n\t\tconst abortController = new AbortController();\n\t\tconst request = new Request(url.toString(), {\n\t\t\tcredentials: 'same-origin',\n\t\t\t...options.fetch,\n\t\t\tmethod,\n\t\t\theaders,\n\t\t\tbody,\n\t\t\tsignal: abortController.signal,\n\t\t});\n\n\t\t// impersonate XHR so that Nette can detect isAjax()\n\t\trequest.headers.set('X-Requested-With', 'XMLHttpRequest');\n\n\t\t// hint the server that Naja expects response to be JSON\n\t\trequest.headers.set('Accept', 'application/json');\n\n\t\tif ( ! this.dispatchEvent(new CustomEvent('before', {cancelable: true, detail: {request, method, url: url.toString(), data, options}}))) {\n\t\t\treturn {};\n\t\t}\n\n\t\tconst promise = window.fetch(request);\n\t\tthis.dispatchEvent(new CustomEvent('start', {detail: {request, promise, abortController, options}}));\n\n\t\tlet response, payload;\n\n\t\ttry {\n\t\t\tresponse = await promise;\n\t\t\tif ( ! response.ok) {\n\t\t\t\tthrow new HttpError(response);\n\t\t\t}\n\n\t\t\tpayload = await response.json();\n\n\t\t} catch (error: any) {\n\t\t\tif (error.name === 'AbortError') {\n\t\t\t\tthis.dispatchEvent(new CustomEvent('abort', {detail: {request, error, options}}));\n\t\t\t\tthis.dispatchEvent(new CustomEvent('complete', {detail: {request, response, payload: undefined, error, options}}));\n\t\t\t\treturn {};\n\t\t\t}\n\n\t\t\tthis.dispatchEvent(new CustomEvent('error', {detail: {request, response, error, options}}));\n\t\t\tthis.dispatchEvent(new CustomEvent('complete', {detail: {request, response, payload: undefined, error, options}}));\n\n\t\t\tthrow error;\n\t\t}\n\n\t\tthis.dispatchEvent(new CustomEvent('payload', {detail: {request, response, payload, options}}));\n\t\tthis.dispatchEvent(new CustomEvent('success', {detail: {request, response, payload, options}}));\n\t\tthis.dispatchEvent(new CustomEvent('complete', {detail: {request, response, payload, error: undefined, options}}));\n\n\t\treturn payload;\n\t}\n\n\tprivate appendToQueryString(searchParams: URLSearchParams, key: string, value: any): void {\n\t\tif (value === null || value === undefined) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (Array.isArray(value) || Object.getPrototypeOf(value) === Object.prototype) {\n\t\t\tfor (const [subkey, subvalue] of Object.entries(value)) {\n\t\t\t\tthis.appendToQueryString(searchParams, `${key}[${subkey}]`, subvalue);\n\t\t\t}\n\n\t\t} else {\n\t\t\tsearchParams.append(key, String(value));\n\t\t}\n\t}\n\n\tprivate transformData(url: URL, method: string, data: any): BodyInit | null {\n\t\tconst isGet = ['GET', 'HEAD'].includes(method.toUpperCase());\n\n\t\t// sending a form via GET -> serialize FormData into URL and return empty request body\n\t\tif (isGet && data instanceof FormData) {\n\t\t\tfor (const [key, value] of data) {\n\t\t\t\tif (value !== null && value !== undefined) {\n\t\t\t\t\turl.searchParams.append(key, String(value));\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn null;\n\t\t}\n\n\t\t// sending a POJO -> serialize it recursively into URLSearchParams\n\t\tconst isDataPojo = data !== null && Object.getPrototypeOf(data) === Object.prototype;\n\t\tif (isDataPojo || Array.isArray(data)) {\n\t\t\t// for GET requests, append values to URL and return empty request body\n\t\t\t// otherwise build `new URLSearchParams()` to act as the request body\n\t\t\tconst transformedData = isGet ? url.searchParams : new URLSearchParams();\n\t\t\tfor (const [key, value] of Object.entries(data)) {\n\t\t\t\tthis.appendToQueryString(transformedData, key, value);\n\t\t\t}\n\n\t\t\treturn isGet\n\t\t\t\t? null\n\t\t\t\t: transformedData;\n\t\t}\n\n\t\treturn data;\n\t}\n\n\tdeclare public addEventListener: <K extends keyof NajaEventMap | string>(type: K, listener: TypedEventListener<Naja, K extends keyof NajaEventMap ? NajaEventMap[K] : CustomEvent>, options?: boolean | AddEventListenerOptions) => void;\n\tdeclare public removeEventListener: <K extends keyof NajaEventMap | string>(type: K, listener: TypedEventListener<Naja, K extends keyof NajaEventMap ? NajaEventMap[K] : CustomEvent>, options?: boolean | AddEventListenerOptions) => void;\n}\n\nexport interface Extension {\n\tinitialize(naja: Naja): void;\n}\n\nexport class HttpError extends Error {\n\tpublic readonly response: Response;\n\n\tconstructor(response: Response) {\n\t\tconst message = `HTTP ${response.status}: ${response.statusText}`;\n\t\tsuper(message);\n\n\t\tthis.name = this.constructor.name;\n\t\tthis.stack = new Error(message).stack;\n\t\tthis.response = response;\n\t}\n}\n\nexport type InitEvent = CustomEvent<{defaultOptions: Options}>;\nexport type BeforeEvent = CustomEvent<{request: Request, method: string, url: string, data: any, options: Options}>;\nexport type StartEvent = CustomEvent<{request: Request, promise: Promise<Response>, abortController: AbortController, options: Options}>;\nexport type AbortEvent = CustomEvent<{request: Request, error: Error, options: Options}>;\nexport type PayloadEvent = CustomEvent<{request: Request, response: Response, payload: Payload, options: Options}>;\nexport type SuccessEvent = CustomEvent<{request: Request, response: Response, payload: Payload, options: Options}>;\nexport type ErrorEvent = CustomEvent<{request: Request, response: Response | undefined, error: Error, options: Options}>;\nexport type CompleteEvent = CustomEvent<{request: Request, response: Response | undefined, error: Error | undefined, payload: Payload | undefined, options: Options}>;\n\ninterface NajaEventMap {\n\tinit: InitEvent;\n\tbefore: BeforeEvent;\n\tstart: StartEvent;\n\tabort: AbortEvent;\n\tpayload: PayloadEvent;\n\tsuccess: SuccessEvent;\n\terror: ErrorEvent;\n\tcomplete: CompleteEvent;\n}\n", "import {CompleteEvent, Extension, Naja, StartEvent} from '../Naja';\nimport {InteractionEvent} from '../core/UIHandler';\n\ndeclare module '../Naja' {\n\tinterface Options {\n\t\tabort?: boolean;\n\t}\n}\n\nexport class AbortExtension implements Extension {\n\tpublic initialize(naja: Naja): void {\n\t\tnaja.uiHandler.addEventListener('interaction', this.checkAbortable.bind(this));\n\t\tnaja.addEventListener('init', this.onInitialize.bind(this));\n\t\tnaja.addEventListener('start', this.saveAbortController.bind(this));\n\t\tnaja.addEventListener('complete', this.removeAbortController.bind(this));\n\t}\n\n\n\tprivate readonly abortControllers: Set<AbortController> = new Set();\n\n\tprivate onInitialize(): void {\n\t\tdocument.addEventListener('keydown', (event) => {\n\t\t\tif (event.key === 'Escape' && !(event.ctrlKey || event.shiftKey || event.altKey || event.metaKey)) {\n\t\t\t\tfor (const controller of this.abortControllers) {\n\t\t\t\t\tcontroller.abort();\n\t\t\t\t}\n\n\t\t\t\tthis.abortControllers.clear();\n\t\t\t}\n\t\t});\n\t}\n\n\tprivate checkAbortable(event: InteractionEvent): void {\n\t\tconst {element, options} = event.detail;\n\t\tif (element.hasAttribute('data-naja-abort') || (element as HTMLInputElement).form?.hasAttribute('data-naja-abort')) {\n\t\t\toptions.abort = (element.getAttribute('data-naja-abort') ?? (element as HTMLInputElement).form?.getAttribute('data-naja-abort')) !== 'off';\n\t\t}\n\t}\n\n\tprivate saveAbortController(event: StartEvent): void {\n\t\tconst {abortController, options} = event.detail;\n\t\tif (options.abort !== false) {\n\t\t\tthis.abortControllers.add(abortController);\n\t\t\toptions.clearAbortExtension = () => this.abortControllers.delete(abortController);\n\t\t}\n\t}\n\n\tprivate removeAbortController(event: CompleteEvent): void {\n\t\tconst {options} = event.detail;\n\t\tif (options.abort !== false && !!options.clearAbortExtension) {\n\t\t\toptions.clearAbortExtension();\n\t\t}\n\t}\n}\n", "import {CompleteEvent, Extension, Naja, StartEvent} from '../Naja';\nimport {InteractionEvent} from '../core/UIHandler';\n\ndeclare module '../Naja' {\n\tinterface Options {\n\t\tunique?: string | false;\n\t}\n}\n\nexport class UniqueExtension implements Extension {\n\tpublic initialize(naja: Naja): void {\n\t\tnaja.uiHandler.addEventListener('interaction', this.checkUniqueness.bind(this));\n\t\tnaja.addEventListener('start', this.abortPreviousRequest.bind(this));\n\t\tnaja.addEventListener('complete', this.clearRequest.bind(this));\n\t}\n\n\n\tprivate readonly abortControllers: Map<string, AbortController> = new Map();\n\n\tprivate checkUniqueness(event: InteractionEvent): void {\n\t\tconst {element, options} = event.detail;\n\t\tif (element.hasAttribute('data-naja-unique') ?? (element as HTMLInputElement).form?.hasAttribute('data-naja-unique')) {\n\t\t\tconst unique = element.getAttribute('data-naja-unique') ?? (element as HTMLInputElement).form?.getAttribute('data-naja-unique');\n\t\t\toptions.unique = unique === 'off' ? false : unique ?? 'default';\n\t\t}\n\t}\n\n\tprivate abortPreviousRequest(event: StartEvent): void {\n\t\tconst {abortController, options} = event.detail;\n\t\tif (options.unique !== false) {\n\t\t\tthis.abortControllers.get(options.unique ?? 'default')?.abort();\n\t\t\tthis.abortControllers.set(options.unique ?? 'default', abortController);\n\t\t}\n\t}\n\n\tprivate clearRequest(event: CompleteEvent): void {\n\t\tconst {request, options} = event.detail;\n\t\tif ( ! request.signal.aborted && options.unique !== false) {\n\t\t\tthis.abortControllers.delete(options.unique ?? 'default');\n\t\t}\n\t}\n}\n", "import {Naja} from './Naja';\nimport {AbortExtension} from './extensions/AbortExtension';\nimport {UniqueExtension} from './extensions/UniqueExtension';\n\n\nconst naja = new Naja();\nnaja.registerExtension(new AbortExtension());\nnaja.registerExtension(new UniqueExtension());\n\nexport type {InitEvent, BeforeEvent, StartEvent, AbortEvent, PayloadEvent, SuccessEvent, ErrorEvent, CompleteEvent} from './Naja';\nexport type {BuildStateEvent, RestoreStateEvent} from './core/HistoryHandler';\nexport type {RedirectEvent} from './core/RedirectHandler';\nexport type {StoreEvent, FetchEvent, RestoreEvent} from './core/SnippetCache';\nexport type {BeforeUpdateEvent, PendingUpdateEvent, AfterUpdateEvent} from './core/SnippetHandler';\nexport type {InteractionEvent} from './core/UIHandler';\n\nexport type {HistoryState} from './core/HistoryHandler';\nexport type {Extension, Options, Payload} from './Naja';\n\nexport {Naja, HttpError} from './Naja';\nexport default naja;\n"],
  "mappings": "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",
  "names": ["naja", "element", "document", "content"]
}
